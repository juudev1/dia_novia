<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="sweetalert2.all.min.js"></script>
  </head>
  <body>
    <div
      class="flex flex-col min-h-[100dvh] bg-gradient-to-b from-[#FFF0F5] to-[#FFE4E1]"
    >
      <header class="px-4 lg:px-6 h-14 flex items-center justify-between">
        <button class="flex items-center justify-center" onclick="startQuiz()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="h-6 w-6 text-[#FF69B4]"
          >
            <path
              d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"
            ></path>
          </svg>
          <span class="sr-only">Romantic Adventure</span>
        </button>
      </header>

      <main
        class="flex-1 flex flex-col items-center justify-center px-4 md:px-6 space-y-6"
      >
        <section id="section-1" class="text-center space-y-4 hidden flex flex-col items-center content-center">
          <h1 class="text-4xl font-bold tracking-tighter text-[#FF69B4]">
            Un Novio muy Enamorado Espera por Ti
          </h1>
          <p class="text-lg max-w-lg text-[#8B4513]">
            Sigue y resuelve las preguntas antes de abrir cada regalo. <br />
            Si respondes incorrectamente, tendrás que esperar 10 minutos para
            responder de nuevo, no intentes engañar al sistema. 😏
          </p>
          <a
            href="#"
            onclick="startQuiz()"
            class="inline-flex h-10 items-center justify-center rounded-md bg-[#FF69B4] px-6 text-sm font-medium text-white shadow transition-colors hover:bg-[#FF1493] focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"
          >
            Empezar la Aventura
          </a>
        </section>

        <!-- ############################################################ -->
        <section
          id="section-2"
          class="text-center space-y-4 hidden"
          data-section-id="2"
        >
          <div
            class="flex items-end justify-end content-center items-center mb-6"
          >
            <h1 class="text-2xl font-bold text-[#000000] mr-3 grow text-left">
              Pregunta #1
            </h1>
            <div
              id="timer"
              class="bg-gray-200 rounded-full px-4 py-2 text-gray-700 font-bold flex justify-end hidden"
            >
              00:00
            </div>
          </div>
          <div>
            <h2 class="text-xl font-bold mb-4 text-[#FF69B4]">
              ¿Qué día empezaste a hablar con tu novio?
            </h2>
            <div class="grid grid-cols-2 gap-4">
              <button
                onclick="checkAnswer(this, '10 de Junio')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                10 de Junio
              </button>
              <button
                onclick="checkAnswer(this, '23 de Abril')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                23 de Abril
              </button>
              <button
                onclick="checkAnswer(this, '13 de Mayo')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                13 de Mayo
              </button>
              <button
                onclick="checkAnswer(this, '13 de Junio')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                13 de Junio
              </button>
            </div>
          </div>
          <div class="letter hidden">
            <img src="assets/letter.png" alt="Carta" class="w-20 mx-auto" />
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left">
              Jamás imaginé que conocería al amor de mi
              vida por internet. Me hiciste sentir especial desde ese primer
              momento.
              <br />
              Fué el 13 de Mayo, el día en que todo este sueño empezó. Todo este tiempo realmente parecías
              interesada en mi, que lo hicieras evidente me hizó el hombre más
              feliz del mundo. <br />
              Gracias por tenerme paciencia y por darme la oportunidad de
              conocerte.
            </p>
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left mt-3">
              Espero que disfrutes mucho estos dulces, te los mereces por ser
              tan preciosa. Sé que los chocolates son tus favoritos, así que
              espero haber hecho una buena elección. 💝😊
            </p>
          </div>

          <button
            class="next-question bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors hidden"
            onclick="goToNextQuestion()"
          >
            Siguiente Pregunta
          </button>
        </section>

        <!-- ############################################################ -->
        <section
          id="section-3"
          class="text-center space-y-4 hidden"
          data-section-id="3"
        >
          <div
            class="flex items-end justify-end content-center items-center mb-6"
          >
            <h1 class="text-2xl font-bold text-[#000000] mr-3 grow text-left">
              Pregunta #2
            </h1>
          </div>
          <div>
            <h2 class="text-xl font-bold mb-4 text-[#FF69B4]">
              ¿Cuando conoció tu novio a tu mamá?
            </h2>
            <div class="grid grid-cols-2 gap-4">
              <button
                onclick="checkAnswer(this, '27 de Mayo')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                24 de Mayo
              </button>
              <button
                onclick="checkAnswer(this, '17 de Mayo')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                17 de Mayo
              </button>
              <button
                onclick="checkAnswer(this, '5 de Junio')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                5 de Junio
              </button>
              <button
                onclick="checkAnswer(this, '22 de Mayo')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                22 de Mayo
              </button>
            </div>
          </div>
          <div class="letter hidden">
            <img src="assets/letter.png" alt="Carta" class="w-20 mx-auto" />
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left">
              Exacto, me engañaste porqué supuestamente me prestarías una
              sombrilla pero en realidad me llevaste a conocer a tu mamá. 😡😾
              <br />
              También estaba tu tió y ambos salieron a saludarme, me sentí muy
              nervioso. No puedo olvidar a Yuki, ella también salió a conocerme
              y el resto de la familia gatuna 💝.
              <br />
              Ese día me diste gomitas de banana jajaja, me encantaron.
            </p>
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left mt-3">
              Te envio un par de gomitas de banana, junto con las que a mi me
              gustan para que las disfrutes. 💝😊
            </p>
          </div>

          <button
            class="next-question bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors hidden"
            onclick="goToNextQuestion()"
          >
            Siguiente Pregunta
          </button>
        </section>

        <!-- ############################################################ -->
        <section
          id="section-4"
          class="text-center space-y-4 hidden"
          data-section-id="4"
        >
          <div
            class="flex items-end justify-end content-center items-center mb-6"
          >
            <h1 class="text-2xl font-bold text-[#000000] mr-3 grow text-left">
              Pregunta #3
            </h1>
          </div>
          <div>
            <h2 class="text-xl font-bold mb-4 text-[#FF69B4]">
              ¿Cual fué el primer día en casa de tu novio?
            </h2>
            <div class="grid grid-cols-2 gap-4">
              <button
                onclick="checkAnswer(this, '29 de mayo')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                29 de mayo
              </button>
              <button
                onclick="checkAnswer(this, '13 de junio')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                13 de junio
              </button>
              <button
                onclick="checkAnswer(this, '22 de junio')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                22 de junio
              </button>
              <button
                onclick="checkAnswer(this, '25 de mayo')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                25 de mayo
              </button>
            </div>
          </div>
          <div class="letter hidden">
            <img src="assets/letter.png" alt="Carta" class="w-20 mx-auto" />
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left">
              El 22 de junio viniste por primera vez a mi casa. Aúnque
              intentamos dormir, a mi me distraia mucho tu presencia y saber que
              tenía a una mujer tan hermosa en mi cama, a unos centímetros de
              mi, no hubó forma de resistirme a tus encantos. 😏
              <br />
              Mi mente estaba divagando y pensando hacerte mil cosas, pero noo,
              era muy pronto para eso. 😅
            </p>
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left mt-3">
              Sé que eres un poquito pícara, así que te envio algo que espero
              ambos podamos disfrutar. 😋 Llevalo en algunas de nuestras
              salidas, creo que será divertido. 😏
            </p>
          </div>

          <button
            class="next-question bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors hidden"
            onclick="goToNextQuestion()"
          >
            Siguiente Pregunta
          </button>
        </section>

        <!-- ############################################################ -->
        <section
          id="section-5"
          class="text-center space-y-4 hidden"
          data-section-id="5"
        >
          <div
            class="flex items-end justify-end content-center items-center mb-6"
          >
            <h1 class="text-2xl font-bold text-[#000000] mr-3 grow text-left">
              Pregunta #4
            </h1>
          </div>
          <div>
            <h2 class="text-xl font-bold mb-4 text-[#FF69B4]">
              ¿Cual es el color favorito de tu novio?
            </h2>
            <div class="grid grid-cols-2 gap-4">
              <button
                onclick="checkAnswer(this, 'Azul')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                Azul
              </button>
              <button
                onclick="checkAnswer(this, 'Verde')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                Verde
              </button>
              <button
                onclick="checkAnswer(this, 'Rojo')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                Rojo
              </button>
              <button
                onclick="checkAnswer(this, 'Negro')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                Negro
              </button>
            </div>
          </div>
          <div class="letter hidden">
            <img src="assets/letter.png" alt="Carta" class="w-20 mx-auto" />
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left">
              No hay mucho que decir, el color negro combina con todo y yo amo
              la ropa oscura. Es curioso porqué el negro no se considera un
              color por todos. Cuando un objeto recibe luz, absorve ciertos
              colores y refleja otros. Ver algo de color azul significa que
              absorvió todos los demás colores y reflejó el azul.
              <br />
              Ver algo negro significa que el objeto absorbió absolutamente
              todos los colores, por lo que si no refleja ninguno, realmente no
              tiene color. El negro es simplemente la ausencia de luz.
              <br />
              Tienes un hombre muy random jajaja.
            </p>
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left mt-3">
              Aunque este regalo no es verde como tal; tu color favorito, si que refleja un color parecido. 😚
              Y de malas, porqué es de mi novela favorita (Harry Potter). Tienes que verte todas las peliculas <3.
            </p>
          </div>

          <button
            class="next-question bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors hidden"
            onclick="goToNextQuestion()"
          >
            Siguiente Pregunta
          </button>
        </section>

        <!-- ############################################################ -->
        <section
          id="section-6"
          class="text-center space-y-4 hidden"
          data-section-id="6"
        >
          <div
            class="flex items-end justify-end content-center items-center mb-6"
          >
            <h1 class="text-2xl font-bold text-[#000000] mr-3 grow text-left">
              Pregunta #5
            </h1>
          </div>
          <div>
            <h2 class="text-xl font-bold mb-4 text-[#FF69B4]">
              ¿Quieres ser mi novia?
            </h2>
            <div class="grid grid-cols-2 gap-4">
              <button
                onclick="checkAnswer(this, 'Si')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                Si
              </button>
              <button
                onclick="checkAnswer(this, 'Si')"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors"
              >
                No
              </button>
            </div>
          </div>
          <div class="letter hidden">
            <img src="assets/letter.png" alt="Carta" class="w-20 mx-auto" />
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left">
              Sé que no soy el mejor hombre del mundo, pero te prometo que haré
              todo lo posible para hacerte feliz. <br />
              Si tu respuesta es afirmativa, prometo ser el mejor novio que
              pueda ser, cuidarte, respetarte y amarte con todo mi corazón.
              <br />
              Si tu respuesta es negativa, no te preocupes, te seguiré esperando
              hasta que estés lista. 💝
            </p>
            <p class="text-[#FF69B4] text-md font-bold max-w-md text-left mt-3">
              Que este regalo sea símbolo del compromiso que tengo contigo.
              Espero que algún día sea yo quien te lo dé en persona. (en un
              altar)
            </p>
          </div>

          <button
            class="next-question bg-gray-200 hover:bg-gray-300 rounded-lg py-3 px-6 transition-colors hidden"
            onclick="goToNextQuestion()"
          >
            Siguiente Pregunta
          </button>
        </section>

        <section id="section-7" class="text-center space-y-4 hidden">
          <h1 class="text-4xl font-bold tracking-tighter text-[#FF69B4]">
            Gracias por jugar
          </h1>
          <p class="text-lg text-[#8B4513] max-w-lg">
            Espero que te haya gustado la aventura, sé que no es mucho pero es
            lo que pude hacer con el tiempo que tenía. <br />
            Feliz día de la novia, te quiero mucho. 💝😊
          </p>
        </section>
      </main>
      <footer
        class="flex flex-col gap-2 sm:flex-row py-6 w-full shrink-0 items-center px-4 md:px-6 border-t"
      >
        <p class="text-xs text-[#8B4513]"></p>
      </footer>
    </div>

    <script>
      // Tiempo en minutos y segundos
      let minutes = 0;
      let seconds = 0;

      // Tiempo total en minutos (se agrega 10 minutos cada vez que se responde incorrectamente)
      let totalMinutes = 0;
      // Variable para almacenar el intervalo del temporizador
      let timerInterval;

      // Selecciona el elemento del temporizador
      const timerElement = document.getElementById("timer");
      const letterElement = document.querySelector(".letter");

      const saveTimerState = () => {
        sessionStorage.setItem("timerMinutes", minutes);
        sessionStorage.setItem("timerSeconds", seconds);
        sessionStorage.setItem("timerTotalMinutes", totalMinutes);
      };

      // Función para cargar el estado del temporizador desde sessionStorage
      const loadTimerState = () => {
        minutes = parseInt(sessionStorage.getItem("timerMinutes")) || 0;
        seconds = parseInt(sessionStorage.getItem("timerSeconds")) || 0;
        totalMinutes =
          parseInt(sessionStorage.getItem("timerTotalMinutes")) || 0;
      };

      // Respuestas correctas por pregunta
      const correctAnswers = {
        2: {
          answer: "13 de Mayo",
          letter: "I love you",
        },
        3: {
          answer: "17 de Mayo",
          letter: "I love you",
        },
        4: {
          answer: "22 de junio",
          letter: "I love you",
        },
        5: {
          answer: "Negro",
          letter: "",
        },
        6: {
          answer: "Si",
          letter: "",
        },
      };

      // Función para actualizar el temporizador
      const updateTimer = () => {
        seconds--;
        if (seconds < 0) {
          if (minutes > 0 || totalMinutes > 0) {
            seconds = 59;
            minutes--;
          } else {
            seconds = 0; // Evita que el temporizador muestre valores negativos
          }
        }
        timerElement.textContent = `${minutes
          .toString()
          .padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;

        // Guarda el estado del temporizador
        saveTimerState();
      };

      // Función para iniciar el temporizador
      const startTimer = () => {
        // Limpia cualquier intervalo anterior
        clearInterval(timerInterval);

        if (totalMinutes > 0) {
          minutes = totalMinutes;
          seconds = 0;
          const intervalId = setInterval(() => {
            updateTimer();
            if (minutes === 0 && seconds === 0) {
              timerElement.classList.add("hidden");
              clearInterval(intervalId);
              enableButtons();
            } else {
              timerElement.classList.remove("hidden");
              timerInterval = intervalId;
              disableButtons();
            }
          }, 1000);
        }
      };

      const checkQuestionStatus = () => {
        const activeSection = sessionStorage.getItem("currentQuestion");
        const section = document.getElementById(`section-${activeSection}`);
        console.log(`question-${activeSection}-answered`);
        console.log(
          sessionStorage.getItem(`question-${activeSection}-answered`)
        );
        if (
          sessionStorage.getItem(`question-${activeSection}-answered`) ===
          "true"
        ) {
          disableButtons();
          section.querySelector(".letter").classList.remove("hidden");
          section.querySelector(".next-question").classList.remove("hidden");
        } else {
          enableButtons();
        }
      };

      // Incrementa el tiempo si la respuesta es incorrecta
      const checkAnswer = (event, answer) => {
        const button = event; // Obtiene el botón que fue clicado
        var section = button.parentElement.parentElement.parentElement; // Encuentra la sección más cercana

        if (section.dataset.sectionId) {
          var questionIndex = section.dataset.sectionId;
        }
        if (answer !== correctAnswers[questionIndex].answer) {
          Swal.fire({
            icon: "error",
            title: "Oops...",
            text: "Respuesta incorrecta",
            footer:
              '<span class="text-[#FF69B4]">Intenta de nuevo en 10 minutos :(</span>',
          });
          totalMinutes = 10; // Incrementa en 10 minutos
          disableButtons();
          startTimer(); // Inicia el temporizador con el tiempo acumulado
        } else {
          Swal.fire({
            title: "Bien hecho!",
            text: "Respuesta correcta",
            icon: "success",
          });
          disableButtons();

          // Marca la pregunta como respondida en sessionStorage
          sessionStorage.setItem(`question-${questionIndex}-answered`, "true");

          // Muestra la carta y el botón "Siguiente Pregunta"
          checkQuestionStatus();
        }
      };

      const goToNextQuestion = () => {
        const currentQuestion = parseInt(
          sessionStorage.getItem("currentQuestion") || "1"
        );
        sessionStorage.setItem("currentQuestion", currentQuestion + 1);
        showQuestion();
      };

      const enableButtons = () => {
        const activeSection = sessionStorage.getItem("currentQuestion");
        const activeSectionEl = document.getElementById(
          `section-${activeSection}`
        );

        if (!activeSectionEl) {
          return;
        }
        const buttons = activeSectionEl.querySelectorAll("button");
        buttons.forEach((button) => {
          button.disabled = false;
          button.classList.remove(
            "disabled:pointer-events-none",
            "disabled:opacity-50"
          );
        });
      };

      const disableButtons = () => {
        const activeSection = sessionStorage.getItem("currentQuestion");
        const activeSectionEl = document.getElementById(
          `section-${activeSection}`
        );
        if (!activeSectionEl) {
          return;
        }
        const sectionsButtons = activeSectionEl.querySelectorAll("button");

        sectionsButtons.forEach((button) => {
          if (button.classList.contains("next-question")) {
            return;
          }
          button.disabled = true;
          button.classList.add(
            "disabled:pointer-events-none",
            "disabled:opacity-50"
          );
        });
      };

      // Función para mostrar la pregunta actual
      const showQuestion = () => {
        const currentQuestion = sessionStorage.getItem("currentQuestion") || 1;
        if (currentQuestion > 1 && currentQuestion != 6) {
          const currentSection = document.getElementById(
            `section-${currentQuestion}`
          );

          currentSection
            .querySelector("h1")
            .insertAdjacentElement("afterend", timerElement);
        }

        for (let i = 1; i <= 7; i++) {
          document.getElementById(`section-${i}`).classList.add("hidden");
          checkQuestionStatus();
        }
        document
          .getElementById(`section-${currentQuestion}`)
          .classList.remove("hidden");
      };

      // Inicia el quiz y muestra la primera pregunta
      const startQuiz = () => {
        sessionStorage.setItem("currentQuestion", 2);
        showQuestion();
      };

      // Muestra la pregunta correcta al cargar la página
      document.addEventListener("DOMContentLoaded", () => {
        disableButtons();
        showQuestion();

        // Carga el estado del temporizador
        loadTimerState();

        // Actualiza el elemento del temporizador con los valores cargados
        timerElement.textContent = `${minutes
          .toString()
          .padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;

        checkQuestionStatus();

        // Inicia el temporizador si hay tiempo restante
        if (minutes > 0 || seconds > 0) {
          disableButtons();
          startTimer();
        } else {
          enableButtons();
        }
      });
    </script>
  </body>
</html>
